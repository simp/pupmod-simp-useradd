<%
  bool_to_yesno = {
    true => 'yes',
    false => 'no'
  }
-%>
[import]
login_defs = <%= @import_login_defs %>
default_useradd = <%= @import_default_useradd %>

[defaults]
<% unless @defaults_modules.empty? -%>
modules = <%= @defaults_modules.join(',') %>
<% end -%>
create_modules = <%= @defaults_create_modules.join(',') %>
crypt_style = <%= @defaults_crypt_style %>
<% unless @defaults_hash_rounds_min.nil? -%>
hash_rounds_min = <%= @defaults_hash_rounds_min %>
<% end -%>
<% unless @defaults_hash_rounds_max.nil? -%>
hash_rounds_max = <%= @defaults_hash_rounds_max %>
<% end -%>
<% unless @defaults_mailspooldir.nil? -%>
mailspooldir = <%= @defaults_mailspooldir %>
<% end -%>
<% unless @defaults_moduledir.nil? -%>
moduledir = <%= @defaults_moduledir %>
<% end -%>
<% unless @defaults_skeleton.nil? -%>
skeleton = <%= @defaults_skeleton %>
<% end -%>

[userdefaults]
<%= @userdefaults %>

[groupdefaults]
<%= @groupdefaults %>

[files]
<% if @defaults_create_modules.include?('files') && !@defaults_modules.include?('files') -%>
<%   unless @files_directory.nil? -%>
directory = <%= @files_directory %>
<%   end -%>
<%   unless @files_nonroot.nil? -%>
nonroot = <%= bool_to_yesno[@files_nonroot] %>
<%   end -%>
<% end -%>

[shadow]
<% if @defaults_create_modules.include?('shadow') && !@defaults_modules.include?('shadow') -%>
<%   unless @shadow_directory.nil? -%>
directory = <%= @shadow_directory %>
<%   end -%>
<%   unless @shadow_nonroot.nil? -%>
nonroot = <%= bool_to_yesno[@shadow_nonroot] %>
<%   end -%>
<% end -%>

[ldap]
<% if @defaults_create_modules.include?('ldap') && !@defaults_modules.include?('ldap') -%>
<%   unless @ldap_userbranch.nil? -%>
userBranch = <%= @ldap_groupbranch %>
<%   end -%>
<%   unless @ldap_groupbranch.nil? -%>
groupBranch = <%= @ldap_groupbranch %>
<%   end -%>
<%   unless @ldap_server.nil? -%>
server = <%= @ldap_server %>
<%   end -%>
<%   unless @ldap_basedn.nil? -%>
basedn = <%= @ldap_basedn %>
<%   end -%>
<%   unless @ldap_binddn.nil? -%>
binddn = <%= @ldap_binddn %>
<%   end -%>
<%   unless @ldap_user.nil? -%>
user = <%= @ldap_user %>
<%   end -%>
<%   unless @ldap_password.nil? -%>
password = <%= @ldap_password %>
<%   end -%>
<%   unless @ldap_authuser.nil? -%>
authuser = <%= @ldap_authuser %>
<%   end -%>
<%   unless @ldap_bindtype.nil? -%>
bindtype = <%= @ldap_bindtype %>
<%   end -%>
<% end -%>

[sasl]
<% unless @sasl_appname.nil? -%>
appname = <%= @sasl_appname %>
<% end -%>
<% unless @sasl_domain.nil? -%>
domain = <%= @sasl_domain%>
<% end -%>
